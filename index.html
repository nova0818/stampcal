<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>éƒµè²»çµ„åˆè¨ˆç®—æ©Ÿ</title>
  <!-- Browser Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect x=%225%22 y=%225%22 width=%2290%22 height=%2290%22 rx=%225%22 fill=%22%2300703c%22/><path d=%22M25 40 L50 60 L75 40%22 fill=%22none%22 stroke=%22white%22 stroke-width=%228%22 stroke-linecap=%22round%22 stroke-linejoin=%22round%22/><rect x=%2220%22 y=%2230%22 width=%2260%22 height=%2245%22 fill=%22none%22 stroke=%22white%22 stroke-width=%225%22 rx=%223%22/><circle cx=%220%22 cy=%220%22 r=%226%22 fill=%22%23f8fafc%22 transform=%22translate(50, 5)%22/><circle cx=%220%22 cy=%220%22 r=%226%22 fill=%22%23f8fafc%22 transform=%22translate(50, 95)%22/><circle cx=%220%22 cy=%220%22 r=%226%22 fill=%22%23f8fafc%22 transform=%22translate(5, 50)%22/><circle cx=%220%22 cy=%220%22 r=%226%22 fill=%22%23f8fafc%22 transform=%22translate(95, 50)%22/></svg>">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Noto+Sans+HK:wght@400;700;900&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            hkPost: {
              light: '#e6f4ea',
              DEFAULT: '#00703c',
              dark: '#004d2a',
            },
            deepPurple: '#0a0118',
            deepBlue: '#010413',
          }
        }
      }
    }
  </script>
  <style>
    body {
      font-family: 'Inter', 'Noto Sans HK', sans-serif;
      touch-action: manipulation;
    }
    .custom-scrollbar::-webkit-scrollbar {
      width: 4px;
    }
    .custom-scrollbar::-webkit-scrollbar-track {
      background: transparent;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb {
      background: #e2e8f0;
      border-radius: 10px;
    }
    .dark .custom-scrollbar::-webkit-scrollbar-thumb {
      background: #475569;
    }
    button {
      touch-action: manipulation;
    }
    .app-container {
      min-height: 100vh;
      min-height: -webkit-fill-available;
      transition: background-color 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }
    * {
      transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease;
    }
  </style>
<link rel="stylesheet" href="/index.css">
</head>
<body class="bg-slate-50 dark:bg-slate-900 overflow-x-hidden">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useMemo, useEffect } = React;

    const DENOMINATIONS = [
      { id: 'd1', value: 0.1, label: '$0.1', color: 'bg-zinc-100 dark:bg-zinc-700' },
      { id: 'd2', value: 0.2, label: '$0.2', color: 'bg-slate-200 dark:bg-slate-600' },
      { id: 'd3', value: 0.5, label: '$0.5', color: 'bg-stone-200 dark:bg-stone-700' },
      { id: 'd4', value: 1.0, label: '$1.0', color: 'bg-emerald-100 dark:bg-emerald-900/40' },
      { id: 'd5', value: 2.0, label: '$2.0', color: 'bg-sky-100 dark:bg-sky-900/40' },
      { id: 'd6', value: 2.2, label: '$2.2', color: 'bg-indigo-100 dark:bg-indigo-900/40' },
      { id: 'd7', value: 2.8, label: '$2.8', color: 'bg-violet-100 dark:bg-violet-900/40' },
      { id: 'd8', value: 3.7, label: '$3.7', color: 'bg-pink-100 dark:bg-pink-900/40' },
      { id: 'd9', value: 4.0, label: '$4.0', color: 'bg-rose-100 dark:bg-rose-900/40' },
      { id: 'd10', value: 5.0, label: '$5.0', color: 'bg-fuchsia-200 dark:bg-fuchsia-900/40' }, 
      { id: 'd11', value: 5.4, label: '$5.4', color: 'bg-orange-100 dark:bg-orange-900/40' },
      { id: 'd12', value: 5.5, label: '$5.5', color: 'bg-yellow-100 dark:bg-yellow-900/40' },
      { id: 'd13', value: 10.0, label: '$10', color: 'bg-red-200 dark:bg-red-900/40' },
      { id: 'd14', value: 15.5, label: '$15.5', color: 'bg-lime-100 dark:bg-lime-900/40' },
      { id: 'd15', value: 20.0, label: '$20', color: 'bg-teal-200 dark:bg-teal-900/40' },
      { id: 'd16', value: 50.0, label: '$50', color: 'bg-cyan-300 dark:bg-cyan-900/40' },
    ];

    const StampIcon = ({ className = "w-5 h-5" }) => (
      <svg className={className} viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M21 8V16C21 18.7614 18.7614 21 16 21H8C5.23858 21 3 18.7614 3 16V8C3 5.23858 5.23858 3 8 3H16C18.7614 3 21 5.23858 21 8Z" fill="#00703c"/>
        <path d="M7 9L12 12.5L17 9" stroke="white" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"/>
        <rect x="6" y="8" width="12" height="8" rx="1" stroke="white" strokeWidth="1.5"/>
        <circle cx="12" cy="3" r="1.5" className="fill-slate-50 dark:fill-slate-900"/>
        <circle cx="12" cy="21" r="1.5" className="fill-slate-50 dark:fill-slate-900"/>
        <circle cx="3" cy="12" r="1.5" className="fill-slate-50 dark:fill-slate-900"/>
        <circle cx="21" cy="12" r="1.5" className="fill-slate-50 dark:fill-slate-900"/>
      </svg>
    );

    function App() {
      const [targetPostage, setTargetPostage] = useState('');
      const [activeTab, setActiveTab] = useState('calc');
      const [isDarkMode, setIsDarkMode] = useState(() => {
        const saved = localStorage.getItem('theme');
        return saved === 'dark';
      });
      const [priority, setPriority] = useState(() => {
        const saved = localStorage.getItem('calc_priority');
        return saved || 'stamps';
      });
      const [disabledStamps, setDisabledStamps] = useState(() => {
        const saved = localStorage.getItem('disabled_stamps');
        return saved ? JSON.parse(saved) : [];
      });

      useEffect(() => {
        if (isDarkMode) {
          document.documentElement.classList.add('dark');
          localStorage.setItem('theme', 'dark');
        } else {
          document.documentElement.classList.remove('dark');
          localStorage.setItem('theme', 'light');
        }
      }, [isDarkMode]);

      useEffect(() => {
        localStorage.setItem('disabled_stamps', JSON.stringify(disabledStamps));
      }, [disabledStamps]);

      useEffect(() => {
        localStorage.setItem('calc_priority', priority);
      }, [priority]);

      const toggleStamp = (id) => {
        setDisabledStamps(prev => 
          prev.includes(id) ? prev.filter(i => i !== id) : [...prev, id]
        );
      };

      const handleKeyPress = (key) => {
        setTargetPostage(prev => {
          if (key === 'C') return '';
          if (key === 'back') return prev.slice(0, -1);
          
          let nextValue = prev;
          if (key === '.') {
            if (prev.includes('.')) return prev;
            nextValue = prev === '' ? '0.' : prev + '.';
          } else {
            nextValue = prev + key;
          }

          const num = parseFloat(nextValue);
          if (nextValue.includes('.') && nextValue.split('.')[1].length > 1) return prev;
          if (!isNaN(num) && num > 9999.9) return prev;
          if (!nextValue.includes('.') && nextValue.length > 4) return prev;

          return nextValue;
        });
      };

      const bestCombination = useMemo(() => {
        const val = parseFloat(targetPostage);
        if (isNaN(val) || val <= 0) return null;
        
        const target = Math.round(val * 10);
        const coins = DENOMINATIONS
                        .filter(d => !disabledStamps.includes(d.id))
                        .map(d => ({ 
                          id: d.id, 
                          val: Math.round(d.value * 10),
                          isInteger: Number.isInteger(d.value)
                        })).sort((a, b) => b.val - a.val);

        const minStampsTable = new Array(target + 1).fill(Infinity);
        minStampsTable[0] = 0;
        for (let i = 1; i <= target; i++) {
          for (const coin of coins) {
            if (i >= coin.val) {
              minStampsTable[i] = Math.min(minStampsTable[i], minStampsTable[i - coin.val] + 1);
            }
          }
        }

        const dp = new Array(target + 1).fill(null);
        dp[0] = { stamps: {}, totalCount: 0, varietyCount: 0, nonIntCount: 0 };

        for (let i = 1; i <= target; i++) {
          const limit = minStampsTable[i] * 2;
          const candidates = [];

          for (const coin of coins) {
            if (i % coin.val === 0) {
              const count = i / coin.val;
              if (count <= limit) {
                candidates.push({
                  stamps: { [coin.id]: count },
                  totalCount: count,
                  varietyCount: 1,
                  nonIntCount: coin.isInteger ? 0 : count
                });
              }
            }
          }

          for (const coin of coins) {
            if (i >= coin.val && dp[i - coin.val] !== null) {
              const prev = dp[i - coin.val];
              const newStamps = { ...prev.stamps };
              newStamps[coin.id] = (newStamps[coin.id] || 0) + 1;
              const currentTotal = prev.totalCount + 1;
              
              if (currentTotal <= limit) {
                candidates.push({
                  stamps: newStamps,
                  totalCount: currentTotal,
                  varietyCount: Object.keys(newStamps).length,
                  nonIntCount: prev.nonIntCount + (coin.isInteger ? 0 : 1)
                });
              }
            }
          }

          if (candidates.length > 0) {
            dp[i] = candidates.reduce((best, current) => {
              if (priority === 'stamps') {
                if (current.totalCount < best.totalCount) return current;
                if (current.totalCount > best.totalCount) return best;
                if (current.varietyCount < best.varietyCount) return current;
                if (current.varietyCount > best.varietyCount) return best;
                return current.nonIntCount < best.nonIntCount ? current : best;
              } else {
                if (current.varietyCount < best.varietyCount) return current;
                if (current.varietyCount > best.varietyCount) return best;
                if (current.totalCount < best.totalCount) return current;
                if (current.totalCount > best.totalCount) return best;
                return current.nonIntCount < best.nonIntCount ? current : best;
              }
            });
          }
        }
        return dp[target];
      }, [targetPostage, disabledStamps, priority]);

      const unavailableStamps = DENOMINATIONS.filter(d => disabledStamps.includes(d.id));

      const bgClasses = useMemo(() => {
        if (priority === 'stamps') {
          return "bg-green-50 dark:bg-deepBlue";
        } else {
          return "bg-purple-50 dark:bg-deepPurple";
        }
      }, [priority]);

      return (
        <div className={`app-container flex flex-col items-center justify-between ${bgClasses}`}>
          <div className="max-w-md w-full flex flex-col p-4 space-y-3">
            
            {activeTab === 'calc' && (
              <>
                <div className="bg-white dark:bg-slate-800/80 backdrop-blur-sm rounded-2xl p-4 shadow-sm border border-slate-200 dark:border-slate-700/50 flex flex-col shrink-0">
                  <div className="flex items-center justify-between mb-3 border-b border-slate-50 dark:border-slate-700/50 pb-2">
                    <div className="flex items-center gap-2">
                      <StampIcon />
                      <h2 className="text-lg font-black text-slate-800 dark:text-slate-100 tracking-tight">éƒµè²»çµ„åˆè¨ˆç®—æ©Ÿ</h2>
                    </div>
                    <div className="flex items-center gap-1">
                      <button 
                        onClick={() => setIsDarkMode(!isDarkMode)}
                        className={`p-1.5 active:scale-95 transition-all ${priority === 'stamps' ? 'text-hkPost' : 'text-purple-500'}`}
                        aria-label="Toggle Theme"
                      >
                        {isDarkMode ? (
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>
                        ) : (
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>
                        )}
                      </button>
                      <button 
                        onClick={() => setActiveTab('settings')}
                        className={`p-1.5 active:scale-95 transition-all ${priority === 'stamps' ? 'text-hkPost' : 'text-purple-500'}`}
                        aria-label="Settings"
                      >
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>
                      </button>
                    </div>
                  </div>
                  
                  <div className="flex items-center justify-between">
                    <div className="flex flex-col flex-1">
                      <h1 className="text-[10px] font-black text-slate-400 dark:text-slate-500 uppercase tracking-widest mb-1">ç›®æ¨™éƒµè²»</h1>
                      <div className="text-4xl font-black text-slate-900 dark:text-white flex items-center gap-1">
                        <span className="text-slate-300 dark:text-slate-600 text-2xl">$</span>
                        <span>{targetPostage || '0'}</span>
                        <span className={`w-0.5 h-8 animate-pulse rounded-full ml-1 ${priority === 'stamps' ? 'bg-hkPost' : 'bg-purple-500'}`}></span>
                      </div>
                    </div>
                    
                    <button 
                      onClick={() => setPriority(prev => prev === 'stamps' ? 'varieties' : 'stamps')}
                      className={`flex flex-col items-center justify-center px-3 py-2 rounded-xl border-2 transition-all active:scale-95 shadow-sm
                        ${priority === 'stamps' 
                          ? 'border-hkPost bg-green-50 dark:bg-green-900/20 text-hkPost dark:text-green-400' 
                          : 'border-purple-500 bg-purple-50 dark:bg-purple-900/20 text-purple-600 dark:text-purple-400'}`}
                    >
                      {priority === 'stamps' ? (
                        <>
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" className="mb-0.5"><rect width="8" height="8" x="3" y="3" rx="1"/><rect width="8" height="8" x="13" y="3" rx="1"/><rect width="8" height="8" x="3" y="13" rx="1"/><rect width="8" height="8" x="13" y="13" rx="1"/></svg>
                          <span className="text-[10px] font-black uppercase tracking-tighter">æ•¸é‡å„ªå…ˆ</span>
                        </>
                      ) : (
                        <>
                          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" className="mb-0.5"><path d="M21 16V8a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2Z"/><path d="M7 12h10"/></svg>
                          <span className="text-[10px] font-black uppercase tracking-tighter">é¢å€¼å„ªå…ˆ</span>
                        </>
                      )}
                    </button>
                  </div>
                </div>

                <div className="shrink-0 flex flex-col space-y-2">
                  <div className="h-[130px] w-full flex-shrink-0">
                    {bestCombination ? (
                      <div className={`h-full bg-white dark:bg-slate-800 rounded-2xl p-2.5 shadow-md border-2 flex flex-col transition-all duration-300 ${priority === 'stamps' ? 'border-hkPost' : 'border-purple-500'}`}>
                        <div className="flex items-center justify-between mb-1 pb-1 border-b border-slate-100 dark:border-slate-700 shrink-0">
                          <h2 className={`text-[11px] font-black uppercase tracking-wider ${priority === 'stamps' ? 'text-hkPost dark:text-green-400' : 'text-purple-600 dark:text-purple-400'}`}>
                            æœ€ä½³æ–¹æ¡ˆ ({bestCombination.totalCount} æš, {bestCombination.varietyCount} æ¬¾)
                          </h2>
                          <button onClick={() => handleKeyPress('C')} className="text-[11px] font-black text-red-500 dark:text-red-400 bg-red-50 dark:bg-red-900/20 px-2 py-0.5 rounded-lg uppercase active:bg-red-100 transition-colors">æ¸…é™¤</button>
                        </div>
                        <div className="flex-1 overflow-y-auto overflow-x-hidden custom-scrollbar">
                          <div className="grid grid-cols-3 gap-y-2 gap-x-1 py-1.5">
                            {Object.entries(bestCombination.stamps).sort((a,b) => {
                               const valA = DENOMINATIONS.find(d => d.id === a[0])?.value || 0;
                               const valB = DENOMINATIONS.find(d => d.id === b[0])?.value || 0;
                               return valB - valA;
                            }).map(([id, count]) => {
                              const denom = DENOMINATIONS.find(d => d.id === id);
                              return (
                                <div key={id} className="flex flex-col items-center">
                                  <div className="flex items-center gap-1">
                                    <div className={`${denom?.color} px-1.5 py-0.5 rounded-lg text-lg font-black text-black dark:text-slate-100 shadow-sm border border-black/10 dark:border-white/10`}>
                                      {denom?.label}
                                    </div>
                                    <div className="flex items-center">
                                      <span className={`${priority === 'stamps' ? 'text-green-400 dark:text-green-500' : 'text-purple-400 dark:text-purple-500'} text-xs font-black mr-0.5`}>Ã—</span>
                                      <span className={`text-2xl font-black leading-none ${priority === 'stamps' ? 'text-hkPost dark:text-green-400' : 'text-purple-600 dark:text-purple-400'}`}>{count}</span>
                                    </div>
                                  </div>
                                </div>
                              );
                            })}
                          </div>
                        </div>
                      </div>
                    ) : (
                      <div className="h-full bg-white/40 dark:bg-slate-800/20 border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-2xl flex flex-col items-center justify-center text-slate-400 dark:text-slate-600 p-6 space-y-2 backdrop-blur-[2px]">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="opacity-20"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M3 9h18"/><path d="M9 21V9"/></svg>
                        <span className="text-[10px] uppercase font-black tracking-widest text-center">
                          {targetPostage && parseFloat(targetPostage) > 0 ? "ç„¡å¯ç”¨çµ„åˆ" : "è«‹è¼¸å…¥é‡‘é¡"}
                        </span>
                      </div>
                    )}
                  </div>

                  <div className="min-h-[28px]">
                    {unavailableStamps.length > 0 && (
                      <div className="flex flex-wrap gap-x-2 gap-y-1.5 items-center px-2 bg-red-50/50 dark:bg-red-900/10 py-1.5 rounded-lg border border-red-100 dark:border-red-900/30">
                        <span className="text-[11px] font-black text-red-600 dark:text-red-400 uppercase tracking-tight shrink-0">ç›®å‰ç¼ºè²¨:</span>
                        <div className="flex flex-wrap gap-x-1.5 gap-y-0.5">
                          {unavailableStamps.map(d => (
                            <span key={d.id} className="text-[11px] font-bold text-red-500 dark:text-red-300">{d.label}</span>
                          ))}
                        </div>
                        <button 
                          onClick={() => setDisabledStamps([])}
                          className={`text-[10px] font-black text-white px-1.5 py-0.5 rounded transition-all shadow-sm active:scale-95 shrink-0 ${priority === 'stamps' ? 'bg-hkPost hover:bg-hkPost-dark' : 'bg-purple-600 hover:bg-purple-700'}`}
                        >
                          å…¨éƒ¨è§£é™¤
                        </button>
                      </div>
                    )}
                  </div>
                </div>

                <div className="pt-1">
                  <div className="grid grid-cols-3 gap-2.5">
                    {['1', '2', '3', '4', '5', '6', '7', '8', '9', '.', '0', 'back'].map((key) => (
                      <button
                        key={key}
                        onClick={() => handleKeyPress(key)}
                        className={`
                          h-12 rounded-xl flex items-center justify-center text-xl font-black transition-all active:scale-95 shadow-sm border
                          ${key === 'back' ? 'bg-slate-200 dark:bg-slate-700 text-slate-600 dark:text-slate-300 border-slate-300 dark:border-slate-600 active:bg-slate-300 dark:active:bg-slate-600' : 'bg-white/80 dark:bg-slate-800/80 backdrop-blur-sm text-slate-800 dark:text-slate-200 border-slate-200 dark:border-slate-700 active:bg-slate-50 dark:active:bg-slate-700'}
                        `}
                      >
                        {key === 'back' ? (
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>
                        ) : key}
                      </button>
                    ))}
                  </div>
                </div>
              </>
            )}

            {activeTab === 'settings' && (
              <div className="space-y-4">
                <div className="bg-white/90 dark:bg-slate-800/90 backdrop-blur-md rounded-2xl p-4 shadow-sm border border-slate-200 dark:border-slate-700">
                  <div className="flex items-center justify-between mb-4">
                    <div className="flex items-center gap-2">
                      <StampIcon />
                      <h2 className="text-lg font-black text-slate-800 dark:text-slate-100 tracking-tight">æ–¹æ¡ˆå„ªå…ˆé †åº</h2>
                    </div>
                  </div>
                  <div className="grid grid-cols-2 gap-3">
                    <button 
                      onClick={() => setPriority('stamps')}
                      className={`flex flex-col items-center justify-center p-3 rounded-xl border-2 transition-all ${priority === 'stamps' ? 'border-hkPost bg-green-50 dark:bg-green-900/20' : 'border-slate-100 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/40 opacity-60'}`}
                    >
                      <span className={`text-xs font-black mb-1 ${priority === 'stamps' ? 'text-hkPost dark:text-green-400' : 'text-slate-500 dark:text-slate-400'}`}>æ•¸é‡å„ªå…ˆ</span>
                      <span className="text-[9px] text-slate-400 dark:text-slate-500 font-bold leading-tight text-center">ä½¿ç”¨æœ€å°‘æ•¸é‡éƒµç¥¨<br/>(é è¨­çµ„åˆ)</span>
                    </button>
                    <button 
                      onClick={() => setPriority('varieties')}
                      className={`flex flex-col items-center justify-center p-3 rounded-xl border-2 transition-all ${priority === 'varieties' ? 'border-purple-500 bg-purple-50 dark:bg-purple-900/20' : 'border-slate-100 dark:border-slate-700 bg-slate-50 dark:bg-slate-800/40 opacity-60'}`}
                    >
                      <span className={`text-xs font-black mb-1 ${priority === 'varieties' ? 'text-purple-600 dark:text-purple-400' : 'text-slate-500 dark:text-slate-400'}`}>é¢å€¼å„ªå…ˆ</span>
                      <span className="text-[9px] text-slate-400 dark:text-slate-500 font-bold leading-tight text-center">æ¸›å°‘é¢é¡ç¨®é¡<br/>(å¯èƒ½æœ‰å‡ºäººæ„è¡¨çš„çµ„åˆ)</span>
                    </button>
                  </div>
                </div>

                <div className="bg-white/90 dark:bg-slate-800/90 backdrop-blur-md rounded-2xl p-4 shadow-sm border border-slate-200 dark:border-slate-700">
                  <div className="flex flex-col mb-4">
                    <div className="flex items-center justify-between mb-1">
                      <div className="flex items-center gap-2">
                        <StampIcon />
                        <h2 className="text-lg font-black text-slate-800 dark:text-slate-100 tracking-tight">åº«å­˜è¨­å®š</h2>
                      </div>
                      <button 
                        onClick={() => setDisabledStamps([])}
                        className={`text-[11px] font-black px-3 py-1 rounded-lg uppercase active:opacity-70 transition-all ${priority === 'stamps' ? 'text-hkPost bg-green-50 dark:bg-green-900/20' : 'text-purple-600 bg-purple-50 dark:bg-purple-900/20'}`}
                      >
                        é‡è¨­å…¨éƒ¨
                      </button>
                    </div>
                    <p className="text-[10px] font-bold text-slate-400 dark:text-slate-500 pl-3">é»æ“Šéƒµç¥¨é¢é¡å³å¯åˆ‡æ›ã€ç¼ºè²¨ã€ç‹€æ…‹ï¼Œè¨ˆç®—æ™‚å°‡æœƒé¿é–‹è©²æ¬¾éƒµç¥¨ã€‚</p>
                  </div>
                  <div className="grid grid-cols-4 gap-3">
                    {DENOMINATIONS.map(d => {
                      const isDisabled = disabledStamps.includes(d.id);
                      return (
                        <button 
                          key={d.id} 
                          onClick={() => toggleStamp(d.id)}
                          className={`relative aspect-square rounded-xl flex items-center justify-center transition-all active:scale-95 shadow-md border-2 text-[17px] font-black
                            ${isDisabled 
                              ? 'bg-slate-100 dark:bg-slate-800 border-slate-200 dark:border-slate-700 text-slate-400 dark:text-slate-600 grayscale opacity-40' 
                              : `${d.color} border-black/5 dark:border-white/5 text-slate-900 dark:text-slate-100`}`}
                        >
                          {d.label}
                          {isDisabled && (
                             <div className="absolute inset-0 flex items-center justify-center pointer-events-none overflow-hidden rounded-xl">
                               <div className="w-[120%] h-[2px] bg-red-500/30 rotate-45 absolute"></div>
                               <div className="w-[120%] h-[2px] bg-red-500/30 -rotate-45 absolute"></div>
                             </div>
                          )}
                        </button>
                      );
                    })}
                  </div>
                  <button 
                    onClick={() => setActiveTab('calc')}
                    className={`w-full mt-6 py-3 text-white font-black rounded-xl shadow-lg active:scale-95 transition-all uppercase tracking-widest text-xs ${priority === 'stamps' ? 'bg-hkPost shadow-green-200 dark:shadow-none' : 'bg-purple-600 shadow-purple-200 dark:shadow-none'}`}
                  >
                    ç¢ºèªä¸¦è¿”å›
                  </button>
                </div>
              </div>
            )}

            {activeTab === 'about' && (
              <div className="bg-white/90 dark:bg-slate-800/90 backdrop-blur-md rounded-2xl p-6 shadow-sm border border-slate-200 dark:border-slate-700 animate-in fade-in slide-in-from-bottom-2 duration-300">
                <div className="flex items-center gap-3 mb-6">
                  <div className={`p-3 rounded-2xl shadow-lg ${priority === 'stamps' ? 'bg-hkPost shadow-hkPost/20' : 'bg-purple-600 shadow-purple-600/20'}`}>
                    <StampIcon className="w-8 h-8" />
                  </div>
                  <div>
                    <h2 className="text-2xl font-black text-slate-800 dark:text-slate-100 tracking-tight leading-none mb-1">é—œæ–¼</h2>
                    <p className={`text-[10px] font-black uppercase tracking-widest ${priority === 'stamps' ? 'text-hkPost' : 'text-purple-600'}`}>éƒµè²»çµ„åˆè¨ˆç®—æ©Ÿ</p>
                  </div>
                </div>

                <div className="space-y-4 text-slate-600 dark:text-slate-400 text-sm font-medium leading-relaxed">
                  <p>é€™æ˜¯ä¸€å€‹æ¥µç°¡ã€æ™ºèƒ½çš„éƒµç¥¨çµ„åˆè¨ˆç®—å·¥å…·ã€‚æ—¨åœ¨å”åŠ©ç”¨æˆ¶åœ¨å¤šæ¨£åŒ–çš„é¢é¡é¸æ“‡ä¸­ï¼Œæ ¹æ“šå¯¦éš›éƒµè²»éœ€æ±‚ï¼Œå¿«é€Ÿå°‹æ‰¾æœ€åˆé©çš„éƒµç¥¨çµ„åˆã€‚</p>
                  
                  <div className="p-4 bg-slate-50 dark:bg-slate-900/50 rounded-xl border border-slate-100 dark:border-slate-700/50">
                    <div className="flex items-center gap-2 mb-2">
                      <svg className={`w-4 h-4 ${priority === 'stamps' ? 'text-emerald-500' : 'text-purple-500'}`} viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2L14.85 9.15L22 12L14.85 14.85L12 22L9.15 14.85L2 12L9.15 9.15L12 2Z" />
                      </svg>
                      <span className="text-[10px] font-black uppercase tracking-widest text-slate-400 dark:text-slate-500">æŠ€è¡“æ”¯æ´</span>
                    </div>
                    <p className="text-xs">æœ¬æ‡‰ç”¨ç¨‹å¼ç”± <span className={`${priority === 'stamps' ? 'text-hkPost' : 'text-purple-600'} font-bold`}>Google Gemini</span> æ¨¡å‹è¼”åŠ©é–‹ç™¼ï¼Œå¯¦ç¾äº†ç²¾ç¢ºçš„çµ„åˆå„ªåŒ–ç®—æ³•èˆ‡æµæš¢çš„ä»‹é¢é«”é©—ã€‚</p>
                  </div>

                  <p className="text-center italic opacity-70 pt-2 border-t border-slate-100 dark:border-slate-700">ã€Œåƒ…ä¾›åƒè€ƒï¼Œç´”å±¬å¥½ç© ğŸ¤¡ã€</p>
                </div>

                <button 
                  onClick={() => setActiveTab('calc')}
                  className={`w-full mt-8 py-3 text-white font-black rounded-xl shadow-lg active:scale-95 transition-all uppercase tracking-widest text-xs ${priority === 'stamps' ? 'bg-hkPost shadow-green-200' : 'bg-purple-600 shadow-purple-200'}`}
                >
                  è¿”å›é¦–é 
                </button>
              </div>
            )}
          </div>

          <footer 
            onClick={() => setActiveTab('about')}
            className="w-full py-6 flex flex-col items-center gap-2 opacity-60 hover:opacity-100 transition-opacity cursor-pointer group"
          >
            <div className="h-[1px] w-12 bg-slate-300 dark:bg-slate-700/50 mb-2"></div>
            <p className={`text-[10px] font-black text-slate-400 dark:text-slate-500 tracking-[0.2em] uppercase transition-colors ${priority === 'stamps' ? 'group-hover:text-hkPost' : 'group-hover:text-purple-600'}`}>
              Just for fun ğŸ¤¡
            </p>
            <div className="flex items-center gap-1.5">
              <svg className={`w-3 h-3 group-hover:scale-110 transition-transform ${priority === 'stamps' ? 'text-hkPost' : 'text-purple-600'}`} viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2L14.85 9.15L22 12L14.85 14.85L12 22L9.15 14.85L2 12L9.15 9.15L12 2Z" />
              </svg>
              <p className={`text-[9px] font-bold text-slate-400 dark:text-slate-600 uppercase tracking-widest transition-colors ${priority === 'stamps' ? 'group-hover:text-hkPost' : 'group-hover:text-purple-600'}`}>
                Powered by Google Gemini
              </p>
            </div>
          </footer>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>